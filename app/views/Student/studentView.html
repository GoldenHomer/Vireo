#{extends 'main.html' /}
#{set title:'View Application' /}

<br />
<div class="row pageHead">
	<h3 class="span11">View Application</h3>
</div>
<br />
<div id="confirmSubmit" class="row">
<form action="@{Student.studentView(subId)}" method="post" class="form-horizontal" enctype="multipart/form-data">
	<legend>About You</legend>
	<div class="control-group">
		<label class="control-label"><b>Name:</b></label>
		<div class="controls">
			<p>${submitter.lastName}, ${submitter.firstName}</p>
		</div>
	</div>
	<div class="control-group">
		<label class="control-label"><b>Email:</b></label>
		<div class="controls">
			<p>${submitter.getEmail()}</p>
		</div>
	</div>
	<div class="control-group">
		<label class="control-label"><b>Year of Birth:</b></label>
		<div class="controls">
			<p>${submitter.getBirthYear()}</p>
		</div>
	</div>
	<div class="control-group">
		<label class="control-label"><b>Phone:</b></label>
		<div class="controls">
			<p>${submitter.getCurrentPhoneNumber()}</p>
		</div>
	</div>
	<div class="control-group">
		<label class="control-label"><b>Address:</b></label>
		<div class="controls">
			<p>${submitter.getCurrentPostalAddress()}</p>
		</div>
	</div>

	
	<legend>Academic Affiliation</legend>
	<div class="control-group">
		<label class="control-label"><b>School:</b></label>
		<div class="controls">
			<p>Texas Digital Library</p>
		</div>
	</div>
	<div class="control-group">
		<label class="control-label"><b>Degree:</b></label>
		<div class="controls">
			<p>${submitter.getCurrentDegree()}</p>
		</div>
	</div>
	<div class="control-group">
		<label class="control-label"><b>Major:</b></label>
		<div class="controls">
			<p>${submitter.getCurrentMajor()}</p>
		</div>
	</div>

	
	<legend>Document Information</legend>
	<div class="control-group">
		<label class="control-label"><b>Title:</b></label>
		<div class="controls">
			<p>${sub.getDocumentTitle()}</p>
		</div>
	</div>
		
	<div class="control-group">
		<label class="control-label"><b>Degree Date:</b></label>
		<div class="controls">
            #{if sub.getGraduationMonth() != null && sub.getGraduationYear() != null}
            %{
              def month = "unknown";
              if (sub.getGraduationMonth() >= 0 && sub.getGraduationMonth() <= 11)
                  month = new java.text.DateFormatSymbols().getMonths()[sub.getGraduationMonth()]
            }% 
                <p>${month} ${sub.getGraduationYear()}</p>
            #{/if}
		</div>
	</div>
	<div class="control-group">
		<label class="control-label"><b>Document Type:</b></label>
		<div class="controls">
			<p>${sub.getDocumentType()}</p>
		</div>
	</div>
	<div class="control-group">
		<label class="control-label"><b>Keywords:</b></label>
		<div class="controls">
			<p>${sub.getDocumentKeywords()}</p>
		</div>
	</div>
	<div class="control-group">
		<label class="control-label"><b>Abstract:</b></label>
		<div class="controls">
			<p>${sub.getDocumentAbstract()}</p>
		</div>
	</div>
	
    #{list items:sub.committeeMembers, as:"member"}	

	<div class="control-group">
		<label class="control-label"><b>Committee Member:</b></label>
		<div class="controls">
			<p>${member.getFirstName()} ${member.getMiddleName()} ${member.getLastName()}</p>
		</div>
	</div>	
	
	#{/list}	
	
	
	<div class="control-group">
		<label class="control-label"><b>Chair Email Address:</b></label>
		<div class="controls">
			<p>${sub.getCommitteeContactEmail()}</p>
		</div>
	</div>
	<div class="control-group">
		<label class="control-label"><b>Embargo:</b></label>
		<div class="controls">
			<p>${sub.getEmbargoType().getDescription()}</p>
		</div>
	</div>

	
	<legend>Uploaded File</legend>
	<div class="control-group">
		<label class="control-label"><b>Primary Document:</b></label>
		
		
		
		   #{if sub.getState().isEditableByStudent()} *{If submission is in needs correction state - show the editor }*
		
	        #{if primaryAttachment == null}
	            <div class="controls">
	                <input type="file" id="primaryFile" class="input-file" name="primaryDocument">
	                <input type="submit" value="Upload" class="uploadBtn btn" name="uploadPrimary">                
	            </div>
	        #{/if}
	        #{else}
	            <div class="controls">
	                <p>
	                    <a href="@{Student.viewPrimaryDocument(subId)}">${primaryAttachment.getName()}</a>
	                    (${primaryAttachment.getDisplaySize()})
	                    <input type="submit" value="Replace Manuscript" class="uploadBtn btn" name="replacePrimary">
	                    
	                </p>
	            </div>
	        #{/else}		
			
			
			<fieldset id="supplementaryFileUpload">
				<div class="control-group">
					<label class="control-label" for="supplementaryFile"><b>Supplementary Files:</b></label>
	
	                <div class="controls">
	                    <input type="file" id="supplementaryFile" class="input-file" name="supplementaryDocument">
	                    <input type="submit" value="Upload" class="uploadBtn btn" name="uploadSupplementary">
	                </div>
				</div>
			</fieldset>
			
	
			<fieldset id="supplementaryFileUploadList">
				<div class="control-group">
	                #{if supplementalAttachments.size() > 0}
	                   
							<table class="span11 table-striped table-bordered">
								<thead>
									<tr>
										<td>Name</td>
										<td>size</td>
									</tr>
								</thead>
				                <tbody>
			                        #{list items:supplementalAttachments, as:"attachment"}
										<tr>
			                                <td>
	                               			   <input type="checkbox" value="${attachment.getId()}" name="attachmentToRemove">
	                          	     			   ${attachment.getName()} 
	                          	     		</td>
	                          	     		<td>   
	                          	     			   ${attachment.getDisplaySize()}  
		                                    </td>
	                                    </tr>
			                        #{/list}
									<tr>
	                  							
									</tr>
								</tbody>
					        </table>	 
					         					
	 						<input type="submit" value="Remove Selected" class="uploadBtn btn" name="removeSupplementary">     
	 
	                #{/if}

			</div>
			
			
			<div class="control-group">
				<label class="control-label"><b>Add Message:</b></label>
				<div class="controls">
					<textarea rows="4" cols="80" name="studentMessage"></textarea>
		            <input class="btn" id="addmsg" name="addmsg" type="submit" value="Add Message" />
				</div>
			</div>			
			
			
			
		</fieldset>				
		#{/if}
		#{else} *{Not editable by student }*
            <div class="controls">
                    <a href="@{Student.viewAttachment(subId,sub.getPrimaryDocument().getId())}">${primaryAttachment.getName()}</a>
                    (${primaryAttachment.getDisplaySize()})                    
            </div>		

	 #{if supplementalAttachments.size() > 0}
			<table class="table-striped table-bordered">
				<thead>
					<tr>
						<td>Name</td>
						<td>size</td>
					</tr>
				</thead>
                <tbody>
                       #{list items:supplementalAttachments, as:"attachment"}
						  <tr>
                                <td>
                 	     		    ${attachment.getName()} 
                    	     	</td>
                    	     	<td>   
                    	     		${attachment.getDisplaySize()}  
                                </td>
                         </tr>
                       #{/list}
				</tbody>
	        </table>	         
	    #{/if}
	                              		
		#{/else}










		
	</div>
	

</form>

<br />
<div>
	<legend>Application Activity</legend>
	<br />
	<table class="span11 table-striped table-bordered">
		<thead>
			<tr>
				<td>Name</td>
				<td>Action</td>
				<td>Time</td>
			</tr>
		</thead>
                <tbody>
                    #{list items:actionLogList, as:'log'}
                    <tr>
                        #{if null != log.getPerson() }
                            <td> ${log.getPerson().getFullName()} </td>
                        #{/if}
                        <td> ${log.getEntry()}  </td>
                        <td> ${log.getActionDate().format('dd MMMM yyyy hh:mm')} </td>	    
                    </tr>
                    #{/list}				
                </tbody>
	</table>
</div>



</div>