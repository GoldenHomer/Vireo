#{extends 'main.html' /}
#{set title:'Submission Status' /}

<br />
<div class="row pageHead">
    <h3 class="span11">Submission Status</h3>
</div>
<br />

#{ifErrors}
<ul class="red">
    #{errors}
        <li>${error}</li>
    #{/errors}
</ul>
#{/ifErrors}


#{if SUBMISSIONS_OPEN}
    <p class="center red large">Currently accepting submissions for the ${CURRENT_SEMESTER} semester.</p>
#{/if}
#{else}
        <p class="alert alert-error">Submissions are currently closed; please contact your thesis office for more information.</p>
#{/else}
    
<div class="row">
    <table class="table table-striped table-bordered table-condensed">    
    
 	<thead>
        <tr>
        	<td>Title</td>
         	<td>Manuscript</td>
         	<td>Status</td>
         	<td>Date Submitted</td>
         	<td>Assigned To</td>
         	<td>Actions</td>
         </tr>
    </thead>
        <tbody>
        
        #{list items:submissionList, as:"submission"}
        
	        <tr>
	            <td>${submission.getDocumentTitle()}</td>
				<td>${controllers.Submit.getDocumentName(submission)}
				
				#{if submission.getPrimaryDocument() != null}
				    <a href="@{Submit.viewAttachment(submission.getId(),submission.getPrimaryDocument().getId())}">[view]</a>
				#{/if}
				
				</td>
				<td>${submission.getState().getDisplayName()}</td>
				<td>${submission.getSubmissionDate()== null?"n/a":submission.getSubmissionDate().format('dd MMMM yyyy')}</td>
				<td>${submission.getAssignee() == null?"Unassigned":submission.getAssignee().getDisplayName()}</td>
				<td> 
				#{if submission.getState().isInProgress()}
				    <a class="btn btn-primary" href="@{submitSteps.PersonalInfo.personalInfo(submission.getId())}">Continue</a>
				    <a class="btn btn-primary" href="@{Submit.deleteSubmission(submission.getId())}">Delete</a>
                #{/if} 
                #{else}
				     <a class="btn btn-primary" href="@{Submit.studentView(submission.getId())}">View</a>				 
				#{/else}
				</td>
				
	        </tr>
        #{/list}

        </tbody></table>
        #{if SUBMISSIONS_OPEN }
	        <div class="form-actions row center">
			    <a href="@{submitSteps.PersonalInfo.personalInfo()}" class="btn btn-primary">Start a new submission</a>
			</div>
		#{/if}
        
</div>

