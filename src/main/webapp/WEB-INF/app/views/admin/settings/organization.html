<div class="admin-settings" ng-controller="OrganizationSettingsController">

	<validationmessage results="organizationRepo.ValidationResults"></validationmessage>
	
	<div class="row">
		<triptych header="ORGANIZATIONS AND WORKFLOWS" managed="true" expcol="false"></triptych>
	</div>

	<div class="row">
		<div id="organizationManagement" class="col-xs-12" ng-controller="OrganizationManagementController">
			<div class="row" ng-if="showOrganizationManagement()">
				<div class="panel-heading">
					<h3 class="panel-title">

						<ul class="inline-list">
							<li ng-click="activateManagementPane('edit')">
								<span	class="management-pane-selector"
										ng-class="{active: managementPaneIsActive('edit')}"
										ng-click="activateManagementPane('edit')" >
										<span class="context-icons glyphicon glyphicon-cog" ng-class="{'active': managementPaneIsActive('edit')}"></span> Manage Organization
								</span>
							</li>
							<li ng-click="activateManagementPane('workflow')">
								<span	class="management-pane-selector"
										ng-click="activateManagementPane('workflow')"
										ng-class="{active: managementPaneIsActive('workflow')}">
										<span class="context-icons glyphicon glyphicon-list-alt" ng-class="{'active': managementPaneIsActive('workflow')}"></span> Manage Workflow
								</span>
							</li>
							<li ng-click="activateManagementPane('email')">
								<span	class="management-pane-selector"
										ng-click="activateManagementPane('email')"
										ng-class="{active: managementPaneIsActive('email')}">
										<span class="context-icons glyphicon glyphicon-envelope" ng-class="{'active': managementPaneIsActive('email')}"></span> Email Workflow Rules
								</span>
							</li>
						</ul>
					</h3>
				</div>
				<div class="col-xs-12 panel-wrap" ng-class="{active: managementPaneIsActive('edit')}">
					<div class="panel panel-default">
						<div class="panel-heading">
							<h3 class="panel-title">Manage {{getSelectedOrganization().name}}</h3>
						</div>

						<div class="panel-body">

							<validationmessage results="getSelectedOrganization().getValidationResults()"></validationmessage>

							<div class="col-md-6">

								<form ng-submit="updateOrganization(getSelectedOrganization())" name="forms.update" novalidate>

									<validatedinput
										label="Name"
										model="getSelectedOrganization()"
										property="name"
										placeholder="Name of the organization"
										form="forms.update"
										validations="getSelectedOrganization().getValidations()"
										results="getSelectedOrganization().getValidationResults()">
									</validatedinput>

									<validatedselect
										label="Category"
										options="organizationCategories"
										optionproperty="name"
										model="getSelectedOrganization()"
										property="category"
										form="forms.update"
										validations="getSelectedOrganization().getValidations()"
										results="getSelectedOrganization().getValidationResults()">
									</validatedselect>

									<div class="pull-right">
										<button
											type="button"
											class="btn btn-danger"
											ng-click="openModal('#organizationConfirmDeleteModal')">Delete Organization</button>
										<button
											type="button"
											class="btn btn-warning"
											ng-click="resetManageOrganization()">Cancel</button>
										<button
											type="submit"
											class="btn btn-primary"
											ng-disabled="forms.update.$invalid">Save</button>
									</div>

								</form>

								<modal modal-id="organizationConfirmDeleteModal"
									modal-view="views/modals/organization/organizationConfirmDeleteModal.html"
									modal-header-class="modal-header-danger"
									modal-backdrop="static">
								</modal>

							</div>
						</div>

					</div>
				</div>
				<div class="col-xs-12 panel-wrap" ng-class="{active: managementPaneIsActive('workflow')}">
					<div class="panel panel-default">
						<div class="panel-heading">
							<h3 class="panel-title">
							Manage {{getSelectedOrganization().name}} Workflow</h3>
						</div>
						<div class="panel-body">

							<button class="btn btn-default modal-add-btn" ng-click="openModal('#addWorkflowStepModal')">
							  Add Workflow Step
							</button>
							<div class="glyphicon glyphicon-info-sign tooltip-span-adjust" tooltip="Dialog in which allows to create workflow step."></div>
							<modal  modal-id="addWorkflowStepModal"
									modal-view="views/modals/organization/workflowStepCreateModal.html"
									modal-header-class="modal-header-primary"
									modal-backdrop="static">
							</modal>
							<accordion single-expand="false" >
								<pane ng-repeat="step in getSelectedOrganization().aggregateWorkflowSteps track by $index" bar-view="views/directives/workflowStep.html" query="{{step.name}}" html="views/directives/workflowStepContent.html">
								{{$index+1}}. {{step.name}}</pane>
							</accordion>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
