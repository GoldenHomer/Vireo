<div class="row admin-settings" ng-controller="OrganizationSettingsController">
	<div class="col-xs-12 triptych" ng-controller="TriptychController">
		<h1>ORGANIZATIONS AND WORKFLOWS</h1>
		<div class="triptych-wraper" ng-class="{'collapse': !triptych.expanded}">
			<div class="row triptych-navigation">
				<div class="row">
					<div class="col-xs-11">
						<ul class="breadcrumb">
							<li ng-click="triptych.resetPanels()"><a href="#">Vireo Institution</a> <span ng-if="triptych.panelHistory.length < 1" class="glyphicon glyphicon-arrow-down"></span></li>
							<li ng-repeat="panel in triptych.panelHistory" ng-click="triptych.rewindPanels(panel)">
								<a href="#">{{panel.selectedOrganization.name}} ({{getCategoryById(panel.selectedOrganization.category).name}})</a>
								<span ng-if="$last" class="glyphicon glyphicon-arrow-down"></span>
							</li>
						</ul>
					</div>
				</div>
			</div>

			<div class="row" ng-if="organizations.list.length < 2">
				<div class="col-xs-12"> 
					<p>Your Institution has no child organizations. Use the 'Create Organization' side module to create your first organization.</p>
				</div>
			</div>

			<div class="row triptych-panels">

				<div class="col-xs-12 col-sm-6 col-md-4 panel-wraper"
					 ng-class="{'closing': panel.closing, 'opening': panel.opening, 'shown': panel.visible}" 
					 ng-repeat="panel in triptych.openPanels" 
					 ng-if="panel.parentOrganization.childrenOrganizations.length>0">

					<div class="panel panel-default triptych-panel"
						 ng-class="{'active': panel.active, 'previously-active': panel.previouslyActive}">

						<div class="panel-heading"> 
							<span 	ng-repeat="category in panel.getPanelCategories()" 
									ng-click="panel.toggleFilter(category)">
								<span 	class="category-heading" 
										ng-class="{'active': category.id == panel.filterOn, 'multiple': panel.getPanelCategories().length > 1}">{{category.name}}</span> 
								<span ng-if="!$last"> / </span> 
							</span>
							<span 	class="glyphicon glyphicon-arrow-right pull-right"
									ng-if="selectedOrganization.childrenOrganizations.length > 0 || panel.previouslyActive">
							</span> 
						</div>
						<div class="panel-body">
							<ul class="list-group">
								<li class="list-group-item"
									ng-repeat="organization in organizations.list | filter:{category:panel.filterOn} | orderBy:'name'" 
									ng-if="filterPanelByParent(panel, organization)" 
									ng-click="shiftPanels(panel, organization);"
									ng-class="{'selected': panel.selectedOrganization.id == organization.id}"
									class="triptych-panel-entry">
									<ul class="inline-list pull-right">
										<li>
											<span class="context-icons glyphicon glyphicon-cog pull-right"></span>
										</li>
										<li>
											<span class="context-icons glyphicon glyphicon-list-alt pull-right"></span>
										</li>
										<li>
											<span class="context-icons glyphicon glyphicon-envelope pull-right"></span>
										</li>
									</ul>
									<span>
										{{organization.name}}
										<span class="badge" ng-if="organization.childrenOrganizations.length">{{organization.childrenOrganizations.length}}</span>
									</span>
									<span class="category-label" ng-if="panel.getPanelCategories().length > 1">{{getCategoryById(organization.category).name}}</span>
								</li>
							</ul>
						</div>

					</div>
					
				</div>
			</div>
		</div>
		<div class="row">
			<div class="divider-wraper col-xs-12">
				<span class="collapse-btn glyphicon glyphicon-chevron-up" ng-if="triptych.expanded" ng-click="triptych.expanded = false"></span>
				<span ng-if="!triptych.expanded">EXPAND NAVIGATION</span>
				<hr class="divider">
				<span class="collapse-btn glyphicon glyphicon-chevron-down" ng-if="!triptych.expanded" ng-click="triptych.expanded = true"></span>
			</div>
		</div>
	</div>
	
</div>